# 3dim_raw_data_to_excel

## 概要
３次元測定器から取得した円測定の生データを、エクセルに変換するpythonプログラム。

業務効率化と、Python学習のために自主作成。  
職場ではエクセルが主流であり、プログラミングを全く使えない人が多いため、エクセルファイル出力とし、
計算式もエクセルファイル上に残すこととした。  
また、プログラムはexe化し、GUI操作で複数の生データ選択とすることで、知識がなくても使用できるようにした。  

## 使用ライブラリ
 - openpyxl
    + excelファイル作成のため
 - re
    + input dataに対し、正規表現で区切り文字指定のため
 - codecs
    + ファイル名が日本語のものに対応するため    
 - pyinstaller
    + pythonプログラムexe化のため。なお、pyinstallerではnumpyを用いたプログラムは重くなるため、numpy, pandas等は使用しないこととした
 - tkinter
    + inputファイル選択のGUI化のため
 - pathlib
    + 読み書きするファイル名の操作のため
 

## input data
この測定器では、一度に測定したn個の円測定データを一つのテキストファイルに書き残す。  
各円測定データは、  
1行目に測定No、 測定部名称、測定データ点数mが、  
2行目～m+1行目に、m点のx,y,z座標値が、  
m+2行目に集計データとして円の中心点のx,y,z座標、平均二乗直径(D)、真円度(d)が与えられる。

データ形式が独特のため、例として2個の円測定を行った際のテキストデータ例を以下に示す。  
(例サンプルの作成簡略化のため、平均二乗直径(D)は"原点からの各点の距離×2"としている)

---

No.: 1;Name:test1;NoOfPnt:      8  
P.No.: 1; X:   4.9837;Y:   0.0000;Z:   0.0000  
P.No.: 2; X:   3.5180;Y:   3.5180;Z:   0.0000  
P.No.: 3; X:   0.0000;Y:   4.9956;Z:   0.0000  
P.No.: 4; X:  -3.5440;Y:   3.5440;Z:   0.0000  
P.No.: 5; X:  -5.0090;Y:   0.0000;Z:   0.0000  
P.No.: 6; X:  -3.5320;Y:  -3.5320;Z:   0.0000  
P.No.: 7; X:  -0.0000;Y:  -4.9824;Z:   0.0000  
P.No.: 8; X:   3.5365;Y:  -3.5365;Z:   0.0000  
X:  -0.0059;Y:   0.0008;Z:   0.0000;D:9.9886;d:  0.0368  
No.: 2;Name:test2;NoOfPnt:     16  
P.No.: 1; X:  10.0028;Y:   0.0000;Z:   0.0000  
P.No.: 2; X:   9.2397;Y:   3.8272;Z:   0.0000  
P.No.: 3; X:   7.0674;Y:   7.0674;Z:   0.0000  
P.No.: 4; X:   3.8264;Y:   9.2378;Z:   0.0000  
P.No.: 5; X:   0.0000;Y:   9.9972;Z:   0.0000  
P.No.: 6; X:  -3.8266;Y:   9.2382;Z:   0.0000  
P.No.: 7; X:  -7.0714;Y:   7.0714;Z:   0.0000  
P.No.: 8; X:  -9.2384;Y:   3.8267;Z:   0.0000  
P.No.: 9; X: -10.0010;Y:   0.0000;Z:   0.0000  
P.No.:10; X:  -9.2437;Y:  -3.8289;Z:   0.0000  
P.No.:11; X:  -7.0728;Y:  -7.0728;Z:   0.0000  
P.No.:12; X:  -3.8301;Y:  -9.2467;Z:   0.0000  
P.No.:13; X:  -0.0000;Y: -10.0063;Z:   0.0000  
P.No.:14; X:   3.8266;Y:  -9.2383;Z:   0.0000  
P.No.:15; X:   7.0687;Y:  -7.0687;Z:   0.0000  
P.No.:16; X:   9.2352;Y:  -3.8253;Z:   0.0000  
X:  -0.0011;Y:  -0.0013;Z:   0.0000;D:20.0012;d:  0.0137  
---

## output data  
詳細はoutput_sample.xlsx を参照ください
### 個別シート
- シート名 = 生データの測定部名称。同じ測定部名称があった場合には_2, _3 ...と自動変換する。  
   + エクセルシート名には31文字以内という制限があるが、測定部名称がこれを超過した際のバグには未対応(測定部名称は通常短いため)  
   + 'summary'という測定部名称があった場合や'?'などシート名に使えない文字を含む場合にもバグが生じるが、
      通常そのような名称は測定部名称とはならないため無視
- 真円からのずれの可視化のため、各点の、半径r_0の円からの距離をグラフ化。
r_0は初期値をプログラム上で用意しているが、エクセルのセル操作で変更可能。
- 測定時にキズやゴミにより異常値が出ることがあるため、各点を用いるかを判定するbool値を用意。
  点を除いた際の集計データ(中心xyz座標、最小二乗直径、真円度)はエクセル数式で自動計算される
### summary シート
- 各点の集計データおよび、グラフ
